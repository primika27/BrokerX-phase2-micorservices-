ADR004 – Messaging avec RabbitMQ pour appariement des ordres

Statut : Acceptée
Date : 2025-10-28
Fichier : /docs/adr/adr004.md

Contexte:

Le système d'appariement (matching engine) nécessite un mécanisme fiable de communication asynchrone entre les services (Order-Service, Matching-Service). L'envoi synchrone via REST ne permet pas une tolérance aux pannes suffisante ni une bonne décorrélation temporelle entre production et traitement des ordres.

Décision:

Utiliser RabbitMQ comme broker de messages. Le service Order-Service agit comme producteur (publish) en envoyant les ordres via une file order.created, tandis que le Matching-Service les consomme pour effectuer le matching selon les règles de prix/temps.

Conséquences:

Découplage fort entre production et traitement des ordres

Tolérance aux pannes améliorée (ordres persistés dans la file si Matching-Service indisponible)

Nécessité de gérer les redéliveries, les accusés de réception (ack) et le format des messages

RabbitMQ devient un composant critique à surveiller

Alternatives considérées:

Appels REST directs (moins résilients)

Kafka (plus complexe à configurer pour le besoin actuel)